"use strict";function t(t){if(t&&t.__esModule)return t;var e={};return t&&Object.keys(t).forEach((function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})})),e.default=t,e}var e,n=(e=require("cross-fetch"))&&"object"==typeof e&&"default"in e?e.default:e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function o(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function u(t,e,n,r){return new(n||(n=Promise))((function(o,i){function u(t){try{s(r.next(t))}catch(t){i(t)}}function a(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(u,a)}s((r=r.apply(t,e||[])).next())}))}function a(t,e){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}var s=function(){function t(t){this.data={},this.data=t}return t.prototype.id=function(){return this.data.id},t.prototype.ref=function(){return this.data.ref},t.prototype.label=function(){return this.data.label},t}(),f=function(){function t(t){this.data={},this.data=t,this.variations=(t.variations||[]).map((function(t){return new s(t)}))}return t.prototype.id=function(){return this.data.id},t.prototype.googleId=function(){return this.data.googleId},t.prototype.name=function(){return this.data.name},t}(),c=function(){function t(t){t&&(this.drafts=(t.drafts||[]).map((function(t){return new f(t)})),this.running=(t.running||[]).map((function(t){return new f(t)})))}return t.prototype.current=function(){return this.running.length>0?this.running[0]:null},t.prototype.refFromCookie=function(t){if(!t||""===t.trim())return null;var e=t.trim().split(" ");if(e.length<2)return null;var n=e[0],r=parseInt(e[1],10),o=this.running.filter((function(t){return t.googleId()===n&&t.variations.length>r}))[0];return o?o.variations[r].ref():null},t}(),p=function(){function t(t,e){for(var n in this.httpClient=e,this.form=t,this.data={},t.fields)t.fields[n].default&&(this.data[n]=[t.fields[n].default])}return t.prototype.set=function(t,e){var n=this.form.fields[t];if(!n)throw new Error("Unknown field "+t);var r=""===e||void 0===e?null:e,o=this.data[t]||[];o=n.multiple?r?o.concat([r]):o:r?[r]:o,this.data[t]=o},t.prototype.url=function(){var t=this.form.action;if(this.data){var e=t.indexOf("?")>-1?"&":"?";for(var n in this.data)if(Object.prototype.hasOwnProperty.call(this.data,n)){var r=this.data[n];if(r)for(var o=0;o<r.length;o++)t+=e+n+"="+encodeURIComponent(r[o]),e="&"}}return t},t.prototype.submit=function(t){return this.httpClient.cachedRequest(this.url()).then((function(e){return t&&t(null,e),e})).catch((function(e){throw t&&t(e),e}))},t}(),h=function(t){function e(e,n){return t.call(this,e,n)||this}return o(e,t),e.prototype.set=function(e,n){return t.prototype.set.call(this,e,n),this},e.prototype.ref=function(t){return this.set("ref",t)},e.prototype.query=function(t){if("string"==typeof t)return this.query([t]);if(Array.isArray(t))return this.set("q","["+t.join("")+"]");throw new Error("Invalid query : "+t)},e.prototype.pageSize=function(t){return this.set("pageSize",t)},e.prototype.graphQuery=function(t){return this.set("graphQuery",t)},e.prototype.lang=function(t){return this.set("lang",t)},e.prototype.page=function(t){return this.set("page",t)},e.prototype.after=function(t){return this.set("after",t)},e.prototype.orderings=function(t){return t?this.set("orderings","["+t.join(",")+"]"):this},e}(p),l=function(t){function e(e,n){return t.call(this,e,n)||this}return o(e,t),e}(p),y="at",d="not",g="missing",m="has",v="any",w="in",b="fulltext",k="similar",A="number.gt",O="number.lt",q="number.inRange",x="date.before",B="date.after",I="date.between",D="date.day-of-month",E="date.day-of-month-after",S="date.day-of-month-before",_="date.day-of-week",j="date.day-of-week-after",T="date.day-of-week-before",F="date.month",P="date.month-before",R="date.month-after",M="date.year",C="date.hour",U="date.hour-before",z="date.hour-after",W="geopoint.near";function N(t){if("string"==typeof t)return'"'+t+'"';if("number"==typeof t)return t.toString();if(t instanceof Date)return t.getTime().toString();if(Array.isArray(t))return"["+t.map((function(t){return N(t)})).join(",")+"]";if("boolean"==typeof t)return t.toString();throw new Error("Unable to encode "+t+" of type "+typeof t)}var Q={near:function(t,e,n,r){return"["+W+"("+t+", "+e+", "+n+", "+r+")]"}},L={before:function(t,e){return"["+x+"("+t+", "+N(e)+")]"},after:function(t,e){return"["+B+"("+t+", "+N(e)+")]"},between:function(t,e,n){return"["+I+"("+t+", "+N(e)+", "+N(n)+")]"},dayOfMonth:function(t,e){return"["+D+"("+t+", "+e+")]"},dayOfMonthAfter:function(t,e){return"["+E+"("+t+", "+e+")]"},dayOfMonthBefore:function(t,e){return"["+S+"("+t+", "+e+")]"},dayOfWeek:function(t,e){return"["+_+"("+t+", "+N(e)+")]"},dayOfWeekAfter:function(t,e){return"["+j+"("+t+", "+N(e)+")]"},dayOfWeekBefore:function(t,e){return"["+T+"("+t+", "+N(e)+")]"},month:function(t,e){return"["+F+"("+t+", "+N(e)+")]"},monthBefore:function(t,e){return"["+P+"("+t+", "+N(e)+")]"},monthAfter:function(t,e){return"["+R+"("+t+", "+N(e)+")]"},year:function(t,e){return"["+M+"("+t+", "+e+")]"},hour:function(t,e){return"["+C+"("+t+", "+e+")]"},hourBefore:function(t,e){return"["+U+"("+t+", "+e+")]"},hourAfter:function(t,e){return"["+z+"("+t+", "+e+")]"}},H={gt:function(t,e){return"["+A+"("+t+", "+e+")]"},lt:function(t,e){return"["+O+"("+t+", "+e+")]"},inRange:function(t,e,n){return"["+q+"("+t+", "+e+", "+n+")]"}},G={at:function(t,e){return"["+y+"("+t+", "+N(e)+")]"},not:function(t,e){return"["+d+"("+t+", "+N(e)+")]"},missing:function(t){return"["+g+"("+t+")]"},has:function(t){return"["+m+"("+t+")]"},any:function(t,e){return"["+v+"("+t+", "+N(e)+")]"},in:function(t,e){return"["+w+"("+t+", "+N(e)+")]"},fulltext:function(t,e){return"["+b+"("+t+", "+N(e)+")]"},similar:function(t,e){return"["+k+'("'+t+'", '+e+")]"},date:L,dateBefore:L.before,dateAfter:L.after,dateBetween:L.between,dayOfMonth:L.dayOfMonth,dayOfMonthAfter:L.dayOfMonthAfter,dayOfMonthBefore:L.dayOfMonthBefore,dayOfWeek:L.dayOfWeek,dayOfWeekAfter:L.dayOfWeekAfter,dayOfWeekBefore:L.dayOfWeekBefore,month:L.month,monthBefore:L.monthBefore,monthAfter:L.monthAfter,year:L.year,hour:L.hour,hourBefore:L.hourBefore,hourAfter:L.hourAfter,number:H,gt:H.gt,lt:H.lt,inRange:H.inRange,near:Q.near,geopoint:Q},J=decodeURIComponent;var K={parse:function(t,e){if("string"!=typeof t)throw new TypeError("argument str must be a string");var n={},r=e||{},o=t.split(/; */),i=r.decode||J;return o.forEach((function(t){var e=t.indexOf("=");if(!(e<0)){var r=t.substr(0,e).trim(),o=t.substr(++e,t.length).trim();'"'==o[0]&&(o=o.slice(1,-1)),null==n[r]&&(n[r]=function(t,e){try{return e(t)}catch(e){return t}}(o,i))}})),n}};function Y(t,e,n){return{token:t,documentId:e,resolve:function(r,o,i){return e&&n?n(e,{ref:t}).then((function(t){if(t){var e=r&&r(t)||t.url||o;return i&&i(null,e),e}return i&&i(null,o),o})):Promise.resolve(o)}}}var V=function(){function t(t,e,n){this.data=t,this.masterRef=t.refs.filter((function(t){return t.isMasterRef}))[0],this.experiments=new c(t.experiments),this.bookmarks=t.bookmarks,this.httpClient=e,this.options=n,this.refs=t.refs,this.tags=t.tags,this.types=t.types,this.languages=t.languages}return t.prototype.form=function(t){var e=this.data.forms[t];return e?"tags"===t?new l(e,this.httpClient):new h(e,this.httpClient):null},t.prototype.searchForm=function(t){var e=this.form(t);return e instanceof h?e:null},t.prototype.tagsForm=function(){var t=this.form("tags");if(!t)throw new Error("Missing tags form");if(t instanceof l)return t;throw new Error("Unexpected error: tags form is not TagsForm")},t.prototype.everything=function(){var t=this.searchForm("everything");if(!t)throw new Error("Missing everything form");return t},t.prototype.master=function(){return this.masterRef.ref},t.prototype.ref=function(t){var e=this.data.refs.filter((function(e){return e.label===t}))[0];return e?e.ref:null},t.prototype.currentExperiment=function(){return this.experiments.current()},t.prototype.query=function(t,e,n){void 0===n&&(n=function(){});var r="function"==typeof e?{options:{},callback:e}:{options:e||{},callback:n},o=r.options,i=r.callback,u=this.everything();for(var a in o)u=u.set(a,o[a]);if(!o.ref){var s="";this.options.req?s=this.options.req.headers.cookie||"":"undefined"!=typeof window&&window.document&&(s=window.document.cookie||"");var f=K.parse(s),c=f["io.prismic.preview"],p=this.experiments.refFromCookie(f["io.prismic.experiment"]);u=u.ref(c||p||this.masterRef.ref)}return t&&u.query(t),u.submit(i)},t.prototype.queryFirst=function(t,e,n){var r="function"==typeof e?{options:{},callback:e}:{options:e||{},callback:n||function(){}},o=r.options,i=r.callback;return o.page=1,o.pageSize=1,this.query(t,o).then((function(t){var e=t&&t.results&&t.results[0];return i(null,e),e})).catch((function(t){throw i(t),t}))},t.prototype.getByID=function(t,e,n){var r=e?i({},e):{};return r.lang||(r.lang="*"),this.queryFirst(G.at("document.id",t),r,n)},t.prototype.getByIDs=function(t,e,n){var r=e?i({},e):{};return r.lang||(r.lang="*"),this.query(G.in("document.id",t),r,n)},t.prototype.getByUID=function(t,e,n,r){var o=n?i({},n):{};if("*"===o.lang)throw new Error("FORBIDDEN. You can't use getByUID with *, use the predicates instead.");return o.page||(o.page=1),this.queryFirst(G.at("my."+t+".uid",e),o,r)},t.prototype.getSingle=function(t,e,n){var r=e?i({},e):{};return this.queryFirst(G.at("document.type",t),r,n)},t.prototype.getBookmark=function(t,e,n){var r=this.data.bookmarks[t];return r?this.getByID(r,e,n):Promise.reject("Error retrieving bookmarked id")},t.prototype.getTags=function(t){return this.tagsForm().submit(t)},t.prototype.getPreviewResolver=function(t,e){return Y(t,e,this.getByID.bind(this))},t}();function X(t){this.size=0,this.limit=t,this._keymap={}}X.prototype.put=function(t,e){var n={key:t,value:e};if(this._keymap[t]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit)return this.shift();this.size++},X.prototype.shift=function(){var t=this.head;return t&&(this.head.newer?(this.head=this.head.newer,this.head.older=void 0):this.head=void 0,t.newer=t.older=void 0,delete this._keymap[t.key]),console.log("purging ",t.key),t},X.prototype.get=function(t,e){var n=this._keymap[t];if(void 0!==n)return n===this.tail||(n.newer&&(n===this.head&&(this.head=n.newer),n.newer.older=n.older),n.older&&(n.older.newer=n.newer),n.newer=void 0,n.older=this.tail,this.tail&&(this.tail.newer=n),this.tail=n),e?n:n.value},X.prototype.find=function(t){return this._keymap[t]},X.prototype.set=function(t,e){var n,r=this.get(t,!0);return r?(n=r.value,r.value=e):(n=this.put(t,e))&&(n=n.value),n},X.prototype.remove=function(t){var e=this._keymap[t];if(e)return delete this._keymap[e.key],e.newer&&e.older?(e.older.newer=e.newer,e.newer.older=e.older):e.newer?(e.newer.older=void 0,this.head=e.newer):e.older?(e.older.newer=void 0,this.tail=e.older):this.head=this.tail=void 0,this.size--,e.value},X.prototype.removeAll=function(){this.head=this.tail=void 0,this.size=0,this._keymap={}},"function"==typeof Object.keys?X.prototype.keys=function(){return Object.keys(this._keymap)}:X.prototype.keys=function(){var t=[];for(var e in this._keymap)t.push(e);return t},X.prototype.forEach=function(t,e,n){var r;if(!0===e?(n=!0,e=void 0):"object"!=typeof e&&(e=this),n)for(r=this.tail;r;)t.call(e,r.key,r.value,this),r=r.older;else for(r=this.head;r;)t.call(e,r.key,r.value,this),r=r.newer},X.prototype.toString=function(){for(var t="",e=this.head;e;)t+=String(e.key)+":"+e.value,(e=e.newer)&&(t+=" < ");return t};var Z=function(){function t(t){void 0===t&&(t=1e3),this.lru=function(t){return new X(t)}(t)}return t.prototype.isExpired=function(t){var e=this.lru.get(t,!1);return!!e&&(0!==e.expiredIn&&e.expiredIn<Date.now())},t.prototype.get=function(t,e){var n=this.lru.get(t,!1);n&&!this.isExpired(t)?e(null,n.data):e&&e(null)},t.prototype.set=function(t,e,n,r){this.lru.remove(t),this.lru.put(t,{data:e,expiredIn:n?Date.now()+1e3*n:0}),r&&r(null)},t.prototype.remove=function(t,e){this.lru.remove(t),e&&e(null)},t.prototype.clear=function(t){this.lru.removeAll(),t&&t(null)},t}();function $(t,e,r){var o,i={headers:{Accept:"application/json"}};e&&e.proxyAgent&&(i.agent=e.proxyAgent);var u=n(t,i);(e.timeoutInMs?Promise.race([u,new Promise((function(n,r){o=setTimeout((function(){return r(new Error(t+" response timeout"))}),e.timeoutInMs)}))]):u).then((function(n){if(clearTimeout(o),429===n.status){var i=Number(n.headers.get("retry-after")),u=Number.isNaN(i)?1e3:i;return new Promise((function(n){setTimeout((function(){$(t,e,r),n()}),u)}))}return~~(n.status/100!=2)?n.text().then((function(){var e=new Error("Unexpected status code ["+n.status+"] on URL "+t);throw e.status=n.status,e})):n.json().then((function(t){var e=n.headers.get("cache-control"),o=e?/max-age=(\d+)/.exec(e):null,i=o?parseInt(o[1],10):void 0;r(null,t,n,i)}))})).catch((function(t){clearTimeout(o),r(t)}))}var tt=function(){function e(t){this.options=t||{},this.initAgents()}return e.prototype.initAgents=function(){return u(this,void 0,void 0,(function(){var e,n,r,o;return a(this,(function(u){switch(u.label){case 0:return"undefined"!=typeof window?[3,3]:[4,new Promise((function(e){e(t(require("http")))}))];case 1:return e=u.sent(),[4,new Promise((function(e){e(t(require("https")))}))];case 2:n=u.sent(),r=new e.Agent({keepAlive:!0}),o=new n.Agent({keepAlive:!0}),this.options=i(i({},this.options),{proxyAgent:function(t){return"http:"===t.protocol?r:o}}),u.label=3;case 3:return[2]}}))}))},e.prototype.request=function(t,e){$(t,this.options,e)},e}(),et=function(){function t(t,e,n,r){this.requestHandler=t||new tt({proxyAgent:n,timeoutInMs:r}),this.cache=e||new Z}return t.prototype.request=function(t,e){this.requestHandler.request(t,(function(t,n,r,o){t?e&&e(t,null,r,o):n&&e&&e(null,n,r,o)}))},t.prototype.cachedRequest=function(t,e){var n=this,r=e||{};return new Promise((function(e,o){var i,u;i=function(t,n){t&&o(t),n&&e(n)},u=r.cacheKey||t,n.cache.get(u,(function(e,o){e||o?i(e,o):n.request(t,(function(t,e,o,a){if(t)i(t,null);else{var s=a||r.ttl;s&&n.cache.set(u,e,s,i),i(null,e)}}))}))}))},t}();var nt=function(){function t(t,e){this.options=e||{},this.url=t;var n=[this.options.accessToken&&"access_token="+this.options.accessToken,this.options.routes&&"routes="+encodeURIComponent(JSON.stringify(this.options.routes))].filter(Boolean);n.length>0&&(this.url+=function(t){return t.indexOf("?")>-1?"&":"?"}(t)+n.join("&")),this.apiDataTTL=this.options.apiDataTTL||5,this.httpClient=new et(this.options.requestHandler,this.options.apiCache,this.options.proxyAgent,this.options.timeoutInMs)}return t.prototype.get=function(t){var e=this;return this.httpClient.cachedRequest(this.url,{ttl:this.apiDataTTL}).then((function(n){var r=new V(n,e.httpClient,e.options);return t&&t(null,r),r})).catch((function(e){throw t&&t(e),e}))},t}(),rt=function(){function t(t,e){this.id=t,this.api=e,this.fields={}}return t.prototype.set=function(t,e){return this.fields[t]=e,this},t.prototype.ref=function(t){return this.set("ref",t)},t.prototype.query=function(t){return this.set("q",t)},t.prototype.pageSize=function(t){return this.set("pageSize",t)},t.prototype.graphQuery=function(t){return this.set("graphQuery",t)},t.prototype.lang=function(t){return this.set("lang",t)},t.prototype.page=function(t){return this.set("page",t)},t.prototype.after=function(t){return this.set("after",t)},t.prototype.orderings=function(t){return this.set("orderings",t)},t.prototype.url=function(){var e=this;return this.api.get().then((function(n){return t.toSearchForm(e,n).url()}))},t.prototype.submit=function(e){var n=this;return this.api.get().then((function(r){return t.toSearchForm(n,r).submit(e)}))},t.toSearchForm=function(t,e){var n=e.searchForm(t.id);if(n)return Object.keys(t.fields).reduce((function(e,n){var r=t.fields[n];return"q"===n?e.query(r):"pageSize"===n?e.pageSize(r):"graphQuery"===n?e.graphQuery(r):"lang"===n?e.lang(r):"page"===n?e.page(r):"after"===n?e.after(r):"orderings"===n?e.orderings(r):e.set(n,r)}),n);throw new Error("Unable to access to form "+t.id)},t}(),ot=function(){function t(t,e){this.api=new nt(t,e)}return t.prototype.getApi=function(){return this.api.get()},t.prototype.everything=function(){return this.form("everything")},t.prototype.form=function(t){return new rt(t,this.api)},t.prototype.query=function(t,e,n){return this.getApi().then((function(r){return r.query(t,e,n)}))},t.prototype.queryFirst=function(t,e,n){return this.getApi().then((function(r){return r.queryFirst(t,e,n)}))},t.prototype.getByID=function(t,e,n){return this.getApi().then((function(r){return r.getByID(t,e,n)}))},t.prototype.getByIDs=function(t,e,n){return this.getApi().then((function(r){return r.getByIDs(t,e,n)}))},t.prototype.getByUID=function(t,e,n,r){return this.getApi().then((function(o){return o.getByUID(t,e,n,r)}))},t.prototype.getSingle=function(t,e,n){return this.getApi().then((function(r){return r.getSingle(t,e,n)}))},t.prototype.getBookmark=function(t,e,n){return this.getApi().then((function(r){return r.getBookmark(t,e,n)}))},t.prototype.getTags=function(){return this.getApi().then((function(t){return t.getTags()}))},t.prototype.getPreviewResolver=function(t,e){var n=this;return Y(t,e,(function(t,e){return n.getApi().then((function(n){return n.getByID(t,e)}))}))},t.getApi=function(t,e){return new nt(t,e).get()},t}(),it={experimentCookie:"io.prismic.experiment",previewCookie:"io.prismic.preview",Predicates:G,predicates:G,Experiments:c,Api:nt,client:function(t,e){return new ot(t,e)},getApi:ut,api:function(t,e){return ut(t,e)}};function ut(t,e){return ot.getApi(t,e)}module.exports=it;
//# sourceMappingURL=client.min.js.map
